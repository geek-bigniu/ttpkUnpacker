define("components/VideoPublish/SearchGame.js",(function(e,t,n,a,r,i,c,u,o,s,l,f,d,p,m,h,g,b,v,y,O,w,k,x,G,j,P,_,L,I,S,V,D){(global.webpackJsonp=global.webpackJsonp||[]).push([["components/VideoPublish/SearchGame"],{"16dc":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=h(n("a34a")),i=h(n("55f8")),c=n("dc04"),u=n("2a36"),o=n("4684"),s=n("5724"),l=n("4260"),f=n("98b4"),d=n("5bf1"),p=n("5aff"),m=n("563a");function h(e){return e&&e.__esModule?e:{default:e}}function g(e,t,n,a,i,c,u){try{var o=e[c](u),s=o.value}catch(e){return void n(e)}o.done?t(s):r.resolve(s).then(a,i)}function b(e){return function(){var t=this,n=arguments;return new r((function(a,r){var i=e.apply(t,n);function c(e){g(i,a,r,c,u,"next",e)}function u(e){g(i,a,r,c,u,"throw",e)}c(void 0)}))}}function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){O(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var w=(0,f.getWindowConfig)().navigationBarHeight,k=u.systemInfo.windowHeight,x=u.systemInfo.screenHeight,G=k>=x?x-w:k,j=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return e.map((function(e){return y(y({},e),{},{names:(0,l.splitKeyWord)(e.Name,t)})}))},P="searchGameList",_={props:{isLastStep:{type:Boolean,default:!0},gameDetail:{type:Object,default:function(){}},gameWhiteList:{type:Array,default:function(){return[]}}},setup:function(e,t){var n=t.emit,r=(0,c.computed)((function(){return!!e.gameWhiteList.length})),u=(0,c.reactive)({mappingId:null,inputHeight:0,searchValue:"",selectGame:null,height:G-304,loading:!1,gameList:r.value?j(e.gameWhiteList,""):[]}),f=(0,c.computed)((function(){return r.value?"请输入本任务所要求的游戏名":(0,i.default)(u.searchValue)?"未搜索到相关游戏，请检查你输入的游戏名":"请输入游戏名搜索"})),h=(0,c.computed)((function(){return!u.mappingId})),g=(0,c.computed)((function(){return e.isLastStep&&!h.value}));(0,c.watch)([function(){return u.selectGame}],b(a.default.mark((function t(){var r,i,c,s,l,f,h,g,b,v;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!u.selectGame){t.next=30;break}return r=[u.selectGame.Name],i=u.selectGame.Id,t.prev=3,c=e.gameDetail.TaskId,t.next=7,(0,o.bindGameList)({game_id:i,bind_game_type:m.gameTypeMap[e.gameDetail.GameId],task_id:c});case 7:if(s=t.sent,l=s.status,f=s.message,h=s.id,g=s.related_unified_game_id,b=void 0===g?null:g,0!==l){t.next=14;break}u.mappingId=h,n("change",h,b),t.next=20;break;case 14:if(!f){t.next=19;break}u.selectGame=null,(0,p.toast)(f),t.next=20;break;case 19:throw s;case 20:t.next=28;break;case 22:t.prev=22,t.t0=t.catch(3),v="验证游戏失败",u.selectGame=null,(0,p.toast)(v),(0,d.report)(v,{msg:JSON.stringify(t.t0),game_list:r,game_id:i});case 28:t.next=32;break;case 30:u.mappingId=null,n("change",null);case 32:case"end":return t.stop()}}),t,null,[[3,22]])}))));var v=(0,l.debounce)(b(a.default.mark((function t(){var n,c,l,f,d,m,h;return a.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.gameDetail.TaskId,c=(0,i.default)(u.searchValue),u.selectGame=null,!c){t.next=21;break}return u.loading=!0,t.prev=5,t.next=8,(0,o.searchGameList)({query:c,task_id:n},P);case 8:l=t.sent,f=l.games,d=void 0===f?[]:f,m=l.status,h=l.message,0===m?u.gameList=j(d,u.searchValue):h&&(u.gameList=[],(0,p.toast)(h)),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(5),console.log("abort",t.t0);case 16:return t.prev=16,u.loading=!1,t.finish(16);case 19:t.next=23;break;case 21:(0,s.abortRequest)(P),r.value?u.gameList=j(e.gameWhiteList):u.gameList=[];case 23:case"end":return t.stop()}}),t,null,[[5,13,16,19]])}))),500,!0,!0);(0,c.watch)([function(){return u.searchValue}],v);var O=(0,c.computed)((function(){var e=u.height,t=u.inputHeight;return"height: ".concat(e,"px; bottom: ").concat(t,"px; transition-delay: ").concat(t?"0.1s":0,";")}));return y(y({},(0,c.toRefs)(u)),{},{popupStyle:O,handleInput:v,handleConfirm:function(){u.selectGame?h.value||n("confirm"):(0,p.toast)("请先选择游戏")},handleClose:function(){n("cancel")},resetInput:function(){u.searchValue=""},onSelect:function(e){u.selectGame=e},inputFocus:function(e){var t=e.detail.height;if(t){var n=G-(t+u.height);u.inputHeight=n>0?t:t+n}},inputBlur:function(){u.inputHeight=0},tips:f,canPublish:g,disable:h})}};t.default=_},"588f":function(e,t,n){},"6b51":function(e,t,n){"use strict";n.r(t);var a=n("16dc"),r=n.n(a);for(var i in a)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return a[e]}))}(i);t.default=r.a},"7a34d":function(e,t,n){"use strict";var a=n("588f");n.n(a).a},"98d1":function(e,t,n){"use strict";n.r(t);var a=n("d737"),r=n("6b51");for(var i in r)["default"].indexOf(i)<0&&function(e){n.d(t,e,(function(){return r[e]}))}(i);n("7a34d");var c=n("f0c5"),u=Object(c.a)(r.default,a.b,a.c,!1,null,"78fa9086",null,!1,a.a,undefined);t.default=u.exports},d737:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){}));var a=function(){this.$createElement;this._self._c},r=[]}}]),(global.webpackJsonp=global.webpackJsonp||[]).push(["components/VideoPublish/SearchGame-create-component",{"components/VideoPublish/SearchGame-create-component":function(e,t,n){n("d1fe").createComponent(n("98d1"))}},[["components/VideoPublish/SearchGame-create-component"]]])}));
//# sourceMappingURL=SearchGame.js.map